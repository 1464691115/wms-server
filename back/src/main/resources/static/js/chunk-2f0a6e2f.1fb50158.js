(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2f0a6e2f"],{"125b":function(e,t,i){},"17ff":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"StockManagerView flex-box flex-column"},[i("search-card-layout",{attrs:{loading:e.loading},on:{"click-search":e.refreshData}},[i("div",{staticClass:"flex-box search-card"},[i("div",{},[i("span",[e._v("货架编号")]),i("el-input",{model:{value:e.filterForm.code,callback:function(t){e.$set(e.filterForm,"code",t)},expression:"filterForm.code"}})],1),i("div",{},[i("span",[e._v("货架名称")]),i("el-input",{model:{value:e.filterForm.name,callback:function(t){e.$set(e.filterForm,"name",t)},expression:"filterForm.name"}})],1),i("div",{},[i("span",[e._v("所属位置")]),i("warehouse-selector",{attrs:{width:"300px",level:2,"is-filter":!0},on:{change:e.warehouseSelectorChange}})],1)]),i("el-button-curd-group",{attrs:{slot:"buttons","delete-disabled":!e.selectedRow.length,"edit-disabled":1!==e.selectedRow.length},on:{"click-add":e.clickAddButton,"click-edit":e.clickEditButton,"click-delete":e.clickDeleteButton},slot:"buttons"})],1),i("div",{staticClass:"flex-grow"},[i("table-panel",{attrs:{loading:e.loading,data:e.data,paginate:e.paginate,"operate-width":"80",selectedRow:e.selectedRow,"create-user-show":!0,"update-user-show":!0},on:{"update:selectedRow":function(t){e.selectedRow=t},"update:selected-row":function(t){e.selectedRow=t},"sort-change":e.sortChange},scopedSlots:e._u([{key:"operate",fn:function(t){var a=t.row;return[i("el-button-mini",{attrs:{type:"text",icon:"edit"},nativeOn:{click:function(t){return e.clickRowEditButton(a)}}}),i("el-button-mini",{attrs:{type:"text",icon:"delete"},nativeOn:{click:function(t){return e.clickRowDeleteButton(a)}}})]}}])},[i("el-table-column",{attrs:{prop:"id",label:"ID",sortable:"custom",width:"80"}}),i("el-table-column",{attrs:{prop:"code",label:"货架编号",sortable:"custom",width:"120"}}),i("el-table-column",{attrs:{prop:"name",label:"货架名称",sortable:"custom",width:"160"}}),i("el-table-column",{attrs:{prop:"warehouseId",label:"所属仓库",sortable:"custom",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[e._v(e._s(i.warehouseName))]}}])}),i("el-table-column",{attrs:{prop:"reservoirId",label:"所属仓位",sortable:"custom",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[e._v(e._s(i.reservoirName))]}}])}),i("el-table-column",{attrs:{prop:"remark",label:"备注","show-overflow-tooltip":!0,sortable:"custom",width:"200"}})],1)],1),i("stock-add-dialog",{attrs:{"edit-id":e.editId,visible:e.showAddDialog},on:{finish:e.refreshData,"update:visible":function(t){e.showAddDialog=t}}})],1)},n=[],r=(i("7f7f"),i("cebc")),s=i("b4d6"),o=i("705a"),l=i("1812"),c=i("41a2"),u=i("558e"),d=i("d225"),h=i("308d"),f=i("6bb5"),b=i("013f"),m=i("4e2b"),p=i("bd86"),v=i("73b5"),w=function(e){function t(){var e,i;Object(d["a"])(this,t);for(var a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return i=Object(h["a"])(this,(e=Object(f["a"])(t)).call.apply(e,[this].concat(n))),Object(p["a"])(Object(b["a"])(i),"id",0),Object(p["a"])(Object(b["a"])(i),"code",""),Object(p["a"])(Object(b["a"])(i),"name",""),Object(p["a"])(Object(b["a"])(i),"remark",""),Object(p["a"])(Object(b["a"])(i),"warehouseId",0),Object(p["a"])(Object(b["a"])(i),"reservoirId",0),Object(p["a"])(Object(b["a"])(i),"warehouseName",""),Object(p["a"])(Object(b["a"])(i),"reservoirName",""),i}return Object(m["a"])(t,e),t}(v["a"]),k=i("7f0d"),g=i("f8d6"),j=i("9960"),O=i("461d"),I=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"StockAddDialog"},[i("el-dialog",{attrs:{visible:e.visible,width:"300px",title:e.editId?"编辑 "+e.stock.id:"新增"},on:{"update:visible":e.showDialog}},[i("el-form",{attrs:{"label-position":"top"}},[i("el-form-item",{attrs:{label:"货架编号"}},[i("el-input",{attrs:{type:"text"},model:{value:e.stock.code,callback:function(t){e.$set(e.stock,"code",t)},expression:"stock.code"}})],1),i("el-form-item",{attrs:{label:"货架名称"}},[i("el-input",{attrs:{type:"text"},model:{value:e.stock.name,callback:function(t){e.$set(e.stock,"name",t)},expression:"stock.name"}})],1),i("el-form-item",{attrs:{label:"所属仓位"}},[i("warehouse-selector",{attrs:{width:"100%",level:2,"is-filter":!1,visible:e.visible,value:e.stock.reservoirId},on:{change:e.warehouseSelectorChange}})],1),i("el-form-item",{attrs:{label:"备注"}},[i("el-input",{attrs:{type:"textarea"},model:{value:e.stock.remark,callback:function(t){e.$set(e.stock,"remark",t)},expression:"stock.remark"}})],1)],1),i("div",{staticClass:"mt-md"},[i("el-button-submit",{attrs:{loading:e.loading,size:"small"},nativeOn:{click:function(t){return e.clickSubmit(t)}}},[e._v("\n                保存提交\n            ")])],1)],1)],1)},D=[],x=i("b5d0"),S=(i("c80a"),{name:"StockAddDialog",components:{WarehouseSelector:g["a"],ElButtonSubmit:x["a"]},props:{visible:{default:!1},editId:{default:0}},data:function(){return{stock:new w,loading:!1}},mounted:function(){this.reload()},methods:{reload:function(){},showDialog:function(e){this.$emit("update:visible",e)},refreshData:function(){var e=this;if(!this.editId)return this.stock=new w;this.loading=!0,this.$ajax.request(l["a"].warehouse.stockGetById,{id:this.editId}).then(function(t){e.stock=t}).finally(function(){return e.loading=!1})},clickSubmit:function(){var e=this,t=this.editId?l["a"].warehouse.stockUpdate:l["a"].warehouse.stockInsert;this.loading=!0,this.$ajax.request(t,this.stock).then(function(t){o["a"].toastSuccess(t),e.showDialog(!1),e.$emit("finish")}).finally(function(){return e.loading=!1})},warehouseSelectorChange:function(e){this.stock.warehouseId=e[0],this.stock.reservoirId=e[1]}},watch:{visible:function(e){e&&this.refreshData()}},computed:{}}),y=S,F=(i("f4f7"),i("2877")),$=Object(F["a"])(y,I,D,!1,null,"78d6faa3",null),_=$.exports,C={name:"StockManagerView",components:{StockAddDialog:_,TablePanel:O["a"],ElButtonMini:j["a"],WarehouseSelector:g["a"],ElButtonCurdGroup:u["a"],SearchCardLayout:s["a"]},props:{},data:function(){return{loading:!1,showAddDialog:!1,filterForm:new w,data:[],paginate:new k["a"](this.refreshData),selectedRow:[],sortingColumn:null,editId:0}},mounted:function(){this.reload()},methods:{reload:function(){this.refreshData()},refreshData:function(){var e=this;this.loading=!0,this.$ajax.request(l["a"].warehouse.stockList,Object(r["a"])({},c["a"].getSortField(this.sortingColumn),this.paginate.getJSON(),this.filterForm)).then(function(t){e.data=t.list,e.paginate.setPaginate(t)}).finally(function(){return e.loading=!1})},sortChange:function(e){this.sortingColumn=e,this.refreshData()},clickAddButton:function(){this.editId=0,this.showAddDialog=!0},clickEditButton:function(){this.editId=this.selectedRow[0].id,this.showAddDialog=!0},clickDeleteButton:function(){this.delete(this.selectedRow)},clickRowEditButton:function(e){this.editId=e.id,this.showAddDialog=!0},clickRowDeleteButton:function(e){this.delete([e])},delete:function(e){var t=this;o["a"].confirm("\n                确定删除以下货架吗？ <br>\n                [ ".concat(e.map(function(e){return e.name}).join(",")," ]\n            ")).then(function(){return t.$ajax.request(l["a"].warehouse.stockDelete,{ids:e.map(function(e){return e.id}).join(",")})}).then(function(e){o["a"].toastSuccess(e),t.refreshData()})},warehouseSelectorChange:function(e){switch(e.length){case 0:this.filterForm.warehouseId=0,this.filterForm.reservoirId=0;break;case 1:this.filterForm.warehouseId=e[0],this.filterForm.reservoirId=0;break;case 2:this.filterForm.warehouseId=e[0],this.filterForm.reservoirId=e[1];break;default:this.filterForm.warehouseId=0,this.filterForm.reservoirId=0;break}}},watch:{},computed:{}},A=C,B=(i("b346"),Object(F["a"])(A,a,n,!1,null,"b7409ea8",null));t["default"]=B.exports},"558e":function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"ElButtonCurdGroup"},[i("el-button-group",[i("el-button-mini",{attrs:{icon:"add",disabled:e.addDisabled},nativeOn:{click:function(t){return e.$emit("click-add")}}},[e._v("添加")]),i("el-button-mini",{attrs:{icon:"edit",disabled:e.editDisabled},nativeOn:{click:function(t){return e.$emit("click-edit")}}},[e._v("编辑")]),i("el-button-mini",{attrs:{icon:"delete",disabled:e.deleteDisabled},nativeOn:{click:function(t){return e.$emit("click-delete")}}},[e._v("删除")])],1),e._t("default")],2)},n=[],r=i("9960"),s={name:"ElButtonCurdGroup",components:{ElButtonMini:r["a"]},props:{addDisabled:{default:!1},editDisabled:{default:!1},deleteDisabled:{default:!1}},data:function(){return{}},mounted:function(){this.reload()},methods:{reload:function(){}},watch:{},computed:{}},o=s,l=(i("fe0a"),i("2877")),c=Object(l["a"])(o,a,n,!1,null,"c8b3903c",null);t["a"]=c.exports},"73b5":function(e,t,i){"use strict";i.d(t,"a",function(){return r});var a=i("d225"),n=i("bd86"),r=(i("5701"),function e(){Object(a["a"])(this,e),Object(n["a"])(this,"createUid",0),Object(n["a"])(this,"updateUid",0),Object(n["a"])(this,"createTime",""),Object(n["a"])(this,"updateTime",""),Object(n["a"])(this,"createUserName",""),Object(n["a"])(this,"updateUserName","")})},"77ea":function(e,t,i){},"7f7f":function(e,t,i){var a=i("86cc").f,n=Function.prototype,r=/^\s*function ([^ (]*)/,s="name";s in n||i("9e1e")&&a(n,s,{configurable:!0,get:function(){try{return(""+this).match(r)[1]}catch(e){return""}}})},"8b21":function(e,t,i){},b13f:function(e,t,i){},b346:function(e,t,i){"use strict";var a=i("8b21"),n=i.n(a);n.a},c80a:function(e,t,i){"use strict";i.d(t,"a",function(){return u});var a=i("d225"),n=i("308d"),r=i("6bb5"),s=i("013f"),o=i("4e2b"),l=i("bd86"),c=i("73b5"),u=function(e){function t(){var e,i;Object(a["a"])(this,t);for(var o=arguments.length,c=new Array(o),u=0;u<o;u++)c[u]=arguments[u];return i=Object(n["a"])(this,(e=Object(r["a"])(t)).call.apply(e,[this].concat(c))),Object(l["a"])(Object(s["a"])(i),"id",0),Object(l["a"])(Object(s["a"])(i),"code",""),Object(l["a"])(Object(s["a"])(i),"warehouseId",0),Object(l["a"])(Object(s["a"])(i),"name",""),Object(l["a"])(Object(s["a"])(i),"remark",""),Object(l["a"])(Object(s["a"])(i),"warehouseName",""),i}return Object(o["a"])(t,e),t}(c["a"])},d60c:function(e,t,i){"use strict";var a=i("77ea"),n=i.n(a);n.a},f4f7:function(e,t,i){"use strict";var a=i("125b"),n=i.n(a);n.a},f8d6:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"WarehouseSelector"},[i("el-cascader",{style:{width:e.width},attrs:{value:e.selectArray,placeholder:e.isFilter?"全部":e.plcText,options:e.tree,props:{value:"id",label:"name"},"change-on-select":e.isFilter},on:{change:e.itemChange}})],1)},n=[],r=(i("6762"),i("2fdb"),i("1812")),s=i("8f16"),o={name:"WarehouseSelector",components:{},props:{value:{default:0},isFilter:{default:!1},level:{default:1},visible:{default:!0},width:{default:"200px"},filterIds:{default:function(){return[]}},needFilter:{default:!1}},data:function(){return{warehouses:[],reservoirs:[],stocks:[],tree:[],selectArray:[]}},mounted:function(){this.reload()},methods:{reload:function(){this.refreshList(),this.change(this.isFilter?0:null)},change:function(e){this.$emit("input",e)},refreshList:function(){var e=this;this.$ajax.request(r["a"].warehouse.warSelectAll).then(function(t){if(e.warehouses=t,e.level>1)return e.$ajax.request(r["a"].warehouse.resSelectAll)}).then(function(t){if(e.reservoirs=t,e.level>2)return e.$ajax.request(r["a"].warehouse.stockSelectAll)}).then(function(t){e.stocks=t}).finally(function(){return e.createTree()})},createTree:function(){var e=this;this.tree=s["a"].listToTreeByTwoList(this.warehouses,s["a"].listToTreeByTwoList(this.reservoirs,this.stocks,"reservoirId"),"warehouseId"),this.isFilter?this.tree=[{id:0,name:"全部"}].concat(this.tree):(this.needFilter||this.filterIds.length)&&(this.tree=s["a"].filterTree(this.tree,function(t){return e.filterIds.includes(t.id)},"children",3)),this.refreshSelect()},refreshSelect:function(){var e=this;this.selectArray=s["a"].getTreeRoute(this.tree,function(t){return t.id===e.value},"id","children",this.level)},itemChange:function(e){!this.isFilter&&e.length<this.level||(this.$emit("input",e.length!==this.level?0:e[e.length-1]),this.$emit("change",e))}},watch:{visible:function(e){e&&this.refreshList()},value:function(){this.refreshSelect()},filterIds:function(){this.createTree()}},computed:{valueUse:function(){return this.value?this.value:this.isFilter?0:null},plcText:function(){return"请选择"+["仓库","仓位","货架"][this.level-1]}}},l=o,c=(i("d60c"),i("2877")),u=Object(c["a"])(l,a,n,!1,null,"afa1b522",null);t["a"]=u.exports},fe0a:function(e,t,i){"use strict";var a=i("b13f"),n=i.n(a);n.a}}]);
//# sourceMappingURL=chunk-2f0a6e2f.1fb50158.js.map