(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-288bd99c"],{"04e9":function(t,e,a){"use strict";var i=a("655b"),n=a.n(i);n.a},"0a29":function(t,e,a){"use strict";var i=a("4d26"),n=a.n(i);n.a},"0d9e":function(t,e,a){"use strict";var i=a("936c"),n=a.n(i);n.a},"10ff":function(t,e,a){var i=a("e53d").parseFloat,n=a("a1ce").trim;t.exports=1/i(a("e692")+"-0")!==-1/0?function(t){var e=n(String(t),3),a=i(e);return 0===a&&"-"==e.charAt(0)?-0:a}:i},"2ec4":function(t,e,a){},4095:function(t,e,a){"use strict";var i=a("2ec4"),n=a.n(i);n.a},"4d26":function(t,e,a){},"4fcb":function(t,e,a){var i=a("63b6"),n=a("10ff");i(i.S+i.F*(Number.parseFloat!=n),"Number",{parseFloat:n})},"558e":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ElButtonCurdGroup"},[a("el-button-group",[a("el-button-mini",{attrs:{icon:"add",disabled:t.addDisabled},nativeOn:{click:function(e){return t.$emit("click-add")}}},[t._v("添加")]),a("el-button-mini",{attrs:{icon:"edit",disabled:t.editDisabled},nativeOn:{click:function(e){return t.$emit("click-edit")}}},[t._v("编辑")]),a("el-button-mini",{attrs:{icon:"delete",disabled:t.deleteDisabled},nativeOn:{click:function(e){return t.$emit("click-delete")}}},[t._v("删除")])],1),t._t("default")],2)},n=[],l=a("9960"),r={name:"ElButtonCurdGroup",components:{ElButtonMini:l["a"]},props:{addDisabled:{default:!1},editDisabled:{default:!1},deleteDisabled:{default:!1}},data:function(){return{}},mounted:function(){this.reload()},methods:{reload:function(){}},watch:{},computed:{}},s=r,o=(a("fe0a"),a("2877")),c=Object(o["a"])(s,i,n,!1,null,"c8b3903c",null);e["a"]=c.exports},"62ca":function(t,e,a){},"655b":function(t,e,a){},"69b9":function(t,e,a){a("4fcb"),t.exports=a("584a").Number.parseFloat},"73b5":function(t,e,a){"use strict";a.d(e,"a",function(){return l});var i=a("d225"),n=a("bd86"),l=(a("5701"),function t(){Object(i["a"])(this,t),Object(n["a"])(this,"createUid",0),Object(n["a"])(this,"updateUid",0),Object(n["a"])(this,"createTime",""),Object(n["a"])(this,"updateTime",""),Object(n["a"])(this,"createUserName",""),Object(n["a"])(this,"updateUserName","")})},"77ea":function(t,e,a){},"7f7f":function(t,e,a){var i=a("86cc").f,n=Function.prototype,l=/^\s*function ([^ (]*)/,r="name";r in n||a("9e1e")&&i(n,r,{configurable:!0,get:function(){try{return(""+this).match(l)[1]}catch(t){return""}}})},"82a3":function(t,e,a){t.exports=a("69b9")},"936c":function(t,e,a){},"977f":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"MaterialManagerContent flex-box flex-column"},[a("search-card-layout",{attrs:{loading:t.loading},on:{"click-search":t.refreshData}},[a("div",{staticClass:"flex-box search-card"},[a("div",{},[a("span",[t._v(t._s(t.nameText)+"编号")]),a("el-input",{model:{value:t.filterForm.code,callback:function(e){t.$set(t.filterForm,"code",e)},expression:"filterForm.code"}})],1),a("div",{},[a("span",[t._v(t._s(t.nameText)+"名称")]),a("el-input",{model:{value:t.filterForm.name,callback:function(e){t.$set(t.filterForm,"name",e)},expression:"filterForm.name"}})],1),a("div",{staticStyle:{width:"200px"}},[a("span",[t._v(t._s(t.nameText)+"分类")]),a("category-selector",{attrs:{type:t.categoryType,"is-filter":!0},model:{value:t.filterForm.categoryId,callback:function(e){t.$set(t.filterForm,"categoryId",e)},expression:"filterForm.categoryId"}})],1),a("div",{staticStyle:{width:"130px"}},[a("span",[t._v("单位")]),a("category-selector",{attrs:{type:1,"is-filter":!0},model:{value:t.filterForm.unitId,callback:function(e){t.$set(t.filterForm,"unitId",e)},expression:"filterForm.unitId"}})],1)]),a("el-button-curd-group",{attrs:{slot:"buttons","delete-disabled":!t.selectedRow.length,"edit-disabled":1!==t.selectedRow.length},on:{"click-add":t.clickAddButton,"click-edit":t.clickEditButton,"click-delete":t.clickDeleteButton},slot:"buttons"})],1),a("div",{staticClass:"flex-grow"},[a("table-panel",{attrs:{loading:t.loading,data:t.data,paginate:t.paginate,"operate-width":"80",selectedRow:t.selectedRow,"create-user-show":!0,"update-user-show":!0},on:{"update:selectedRow":function(e){t.selectedRow=e},"update:selected-row":function(e){t.selectedRow=e},"sort-change":t.sortChange},scopedSlots:t._u([{key:"operate",fn:function(e){var i=e.row;return[a("el-button-mini",{attrs:{type:"text",icon:"edit"},nativeOn:{click:function(e){return t.clickRowEditButton(i)}}}),a("el-button-mini",{attrs:{type:"text",icon:"delete"},nativeOn:{click:function(e){return t.clickRowDeleteButton(i)}}})]}}])},[a("el-table-column",{attrs:{prop:"id",label:"ID",sortable:"custom",width:"80"}}),a("el-table-column",{attrs:{prop:"code",label:t.nameText+"编号",sortable:"custom",width:"140"}}),a("el-table-column",{attrs:{prop:"name",label:t.nameText+"名称",sortable:"custom",width:"160"}}),a("el-table-column",{attrs:{prop:"categoryId",label:t.nameText+"分类",sortable:"custom",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(t._s(a.categoryName))]}}])}),a("el-table-column",{attrs:{prop:"unitId",label:"单位",sortable:"custom",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(t._s(a.unitName))]}}])}),a("el-table-column",{attrs:{prop:"safeNum",label:"安全数量",sortable:"custom",width:"100"}}),a("el-table-column",{attrs:{prop:"validDay",label:"有效天数",sortable:"custom",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(t._s(a.validDay||"永久有效"))]}}])}),a("el-table-column",{attrs:{prop:"remark",label:"备注",width:"160"}})],1)],1),a("material-add-dialog",{attrs:{"edit-id":t.editId,visible:t.showAddDialog,"category-type":t.categoryType,type:t.type},on:{"update:visible":function(e){t.showAddDialog=e},finish:t.refreshData}})],1)},n=[],l=(a("7f7f"),a("cebc")),r=a("705a"),s=a("41a2"),o=a("1812"),c=a("b4d6"),u=a("558e"),d=a("461d"),f=a("9960"),h=a("d225"),m=a("308d"),p=a("6bb5"),b=a("013f"),v=a("4e2b"),g=a("bd86"),y=a("73b5"),w=function(t){function e(){var t,a;Object(h["a"])(this,e);for(var i=arguments.length,n=new Array(i),l=0;l<i;l++)n[l]=arguments[l];return a=Object(m["a"])(this,(t=Object(p["a"])(e)).call.apply(t,[this].concat(n))),Object(g["a"])(Object(b["a"])(a),"id",0),Object(g["a"])(Object(b["a"])(a),"code",""),Object(g["a"])(Object(b["a"])(a),"name",""),Object(g["a"])(Object(b["a"])(a),"type",0),Object(g["a"])(Object(b["a"])(a),"categoryId",""),Object(g["a"])(Object(b["a"])(a),"unitId",""),Object(g["a"])(Object(b["a"])(a),"safeNum",0),Object(g["a"])(Object(b["a"])(a),"validDay",0),Object(g["a"])(Object(b["a"])(a),"remark",""),Object(g["a"])(Object(b["a"])(a),"categoryName",""),Object(g["a"])(Object(b["a"])(a),"unitName",""),a}return Object(v["a"])(e,t),e}(y["a"]),x=a("7f0d"),k=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"MaterialAddDialog"},[a("el-dialog",{attrs:{visible:t.visible,width:"300px",title:t.editId?"编辑 "+t.material.id:"新增"},on:{"update:visible":t.showDialog}},[a("el-form",{attrs:{"label-position":"top"}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:t.nameText+"编号",required:!0}},[a("el-input",{attrs:{type:"text"},model:{value:t.material.code,callback:function(e){t.$set(t.material,"code",e)},expression:"material.code"}})],1)],1)],1),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:t.nameText+"名称",required:!0}},[a("el-input",{attrs:{type:"text"},model:{value:t.material.name,callback:function(e){t.$set(t.material,"name",e)},expression:"material.name"}})],1)],1)],1),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:15}},[a("el-form-item",{attrs:{label:t.nameText+"分类",required:!0}},[a("category-selector",{attrs:{type:t.categoryType,"is-filter":!1},model:{value:t.material.categoryId,callback:function(e){t.$set(t.material,"categoryId",e)},expression:"material.categoryId"}})],1)],1),a("el-col",{attrs:{span:9}},[a("el-form-item",{attrs:{label:"单位",required:!0}},[a("category-selector",{attrs:{type:1,"is-filter":!1},model:{value:t.material.unitId,callback:function(e){t.$set(t.material,"unitId",e)},expression:"material.unitId"}})],1)],1)],1),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"安全库存",required:!0}},[a("el-input-integer",{model:{value:t.material.safeNum,callback:function(e){t.$set(t.material,"safeNum",e)},expression:"material.safeNum"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{required:!0}},[a("template",{slot:"label"},[t._v("\n                            有效天数\n                            "),a("el-tooltip",{attrs:{effect:"dark",content:"0 代表该物料永久有效",placement:"top-start"}},[a("i",{staticClass:"iconfont icon-exclamation-circle cursor-p"})])],1),a("el-input",{model:{value:t.material.validDay,callback:function(e){t.$set(t.material,"validDay",e)},expression:"material.validDay"}})],2)],1)],1),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.material.remark,callback:function(e){t.$set(t.material,"remark",e)},expression:"material.remark"}})],1)],1),a("div",{staticClass:"mt-md"},[a("el-button-submit",{attrs:{loading:t.loading,size:"small"},nativeOn:{click:function(e){return t.clickSubmit(e)}}},[t._v("\n                保存提交\n            ")])],1)],1)],1)},j=[],O=(a("4917"),a("b5d0")),F=a("f8d6"),D=a("a9cf"),I=a("ef7c"),_=a("bf8a"),T={name:"MaterialAddDialog",components:{ElInputInteger:_["a"],CategorySelector:I["a"],CategoryTypeSelector:D["a"],WarehouseSelector:F["a"],ElButtonSubmit:O["a"]},props:{visible:{default:!1},editId:{default:0},categoryType:{default:2},type:{default:1}},data:function(){return{material:new w,loading:!1}},mounted:function(){this.reload()},methods:{reload:function(){},showDialog:function(t){this.$emit("update:visible",t)},refreshData:function(){var t=this;if(!this.editId)return this.material=new w;this.loading=!0,this.$ajax.request(o["a"].material.getById,{id:this.editId}).then(function(e){t.material=e}).finally(function(){return t.loading=!1})},clickSubmit:function(){var t=this,e=this.editId?o["a"].material.update:o["a"].material.insert;this.loading=!0,this.material.type=this.type,this.$ajax.request(e,this.material).then(function(e){r["a"].toastSuccess(e),t.showDialog(!1),t.$emit("finish")}).finally(function(){return t.loading=!1})}},watch:{visible:function(t){t&&this.refreshData()},"material.safeNum":function(t){var e=(t+"").match(/[1-9]\d*/);this.material.safeNum=e?e[0]:0},"material.validDay":function(t){var e=(t+"").match(/[1-9]\d*/);this.material.validDay=e?e[0]:0}},computed:{nameText:function(){return 2===this.categoryType?"物料":"产品"}}},$=T,S=(a("0d9e"),a("2877")),C=Object(S["a"])($,k,j,!1,null,"4e817240",null),U=C.exports,E={name:"MaterialManagerContent",components:{CategorySelector:I["a"],MaterialAddDialog:U,ElButtonMini:f["a"],TablePanel:d["a"],ElButtonCurdGroup:u["a"],SearchCardLayout:c["a"]},props:{type:{default:1}},data:function(){return{loading:!1,showAddDialog:!1,filterForm:new w,data:[],paginate:new x["a"](this.refreshData),selectedRow:[],sortingColumn:null,editId:0}},mounted:function(){this.reload()},methods:{reload:function(){this.refreshData()},refreshData:function(){var t=this;this.loading=!0,this.filterForm.type=this.type,this.$ajax.request(o["a"].material.list,Object(l["a"])({},s["a"].getSortField(this.sortingColumn),this.paginate.getJSON(),this.filterForm)).then(function(e){t.data=e.list,t.paginate.setPaginate(e)}).finally(function(){return t.loading=!1})},sortChange:function(t){this.sortingColumn=t,this.refreshData()},clickAddButton:function(){this.editId=0,this.showAddDialog=!0},clickEditButton:function(){this.editId=this.selectedRow[0].id,this.showAddDialog=!0},clickDeleteButton:function(){this.delete(this.selectedRow)},clickRowEditButton:function(t){this.editId=t.id,this.showAddDialog=!0},clickRowDeleteButton:function(t){this.delete([t])},delete:function(t){var e=this;r["a"].confirm("\n                确定删除以下部门吗？ <br>\n                [ ".concat(t.map(function(t){return t.name}).join(",")," ]\n            ")).then(function(){return e.$ajax.request(o["a"].material.delete,{ids:t.map(function(t){return t.id}).join(",")})}).then(function(t){r["a"].toastSuccess(t),e.refreshData()})}},watch:{},computed:{categoryType:function(){return 1===this.type?2:7},nameText:function(){return 1===this.type?"物料":"产品"}}},A=E,B=(a("ac66"),Object(S["a"])(A,i,n,!1,null,"5417e8ce",null));e["a"]=B.exports},a1ce:function(t,e,a){var i=a("63b6"),n=a("25eb"),l=a("294c"),r=a("e692"),s="["+r+"]",o="​",c=RegExp("^"+s+s+"*"),u=RegExp(s+s+"*$"),d=function(t,e,a){var n={},s=l(function(){return!!r[t]()||o[t]()!=o}),c=n[t]=s?e(f):r[t];a&&(n[a]=c),i(i.P+i.F*s,"String",n)},f=d.trim=function(t,e){return t=String(n(t)),1&e&&(t=t.replace(c,"")),2&e&&(t=t.replace(u,"")),t};t.exports=d},a9cf:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"CategoryTypeSelector"},[a("el-select",{attrs:{value:t.valueUse,placeholder:"选择分类"},on:{input:t.change}},[t.isFilter?a("el-option",{attrs:{label:"全部",value:0}}):t._e(),a("el-option",{attrs:{label:t.category[1],value:1}}),a("el-option",{attrs:{label:t.category[2],value:2}}),a("el-option",{attrs:{label:t.category[3],value:3}}),a("el-option",{attrs:{label:t.category[4],value:4}}),a("el-option",{attrs:{label:t.category[5],value:5}}),a("el-option",{attrs:{label:t.category[6],value:6}}),a("el-option",{attrs:{label:t.category[7],value:7}})],1)],1)},n=[],l={1:"单位类别",2:"物料类别",3:"入库单",4:"出库单",5:"设备分类",6:"设备产权",7:"产品分类"},r={name:"CategoryTypeSelector",components:{},props:{value:{default:0},isFilter:{default:!1}},data:function(){return{category:l}},mounted:function(){this.reload()},methods:{reload:function(){this.change(this.isFilter?0:null)},change:function(t){this.$emit("input",t)}},watch:{},computed:{valueUse:function(){return this.value?this.value:this.isFilter?0:null}}},s=r,o=(a("4095"),a("2877")),c=Object(o["a"])(s,i,n,!1,null,"115871d6",null);e["a"]=c.exports},ac66:function(t,e,a){"use strict";var i=a("62ca"),n=a.n(i);n.a},b13f:function(t,e,a){},bf8a:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ElInputInteger"},[a("el-input",{model:{value:t.valueUse,callback:function(e){t.valueUse=e},expression:"valueUse"}})],1)},n=[],l=a("82a3"),r=a.n(l),s=a("75fc"),o=(a("4917"),a("3b2b"),{name:"ElInputInteger",components:{},props:{value:{default:0},isFloat:{default:!1},min:{default:0},max:{default:99999999}},data:function(){return{valueUse:this.value}},mounted:function(){this.reload()},methods:{reload:function(){}},watch:{valueUse:function(t){var e=new RegExp("[1-9]\\d{0,8}");this.isFloat&&(e=new RegExp("^\\d{1,8}\\.{0,1}\\d{0,2}"));var a=(t+"").match(e);this.valueUse=a?a[0]:0,this.valueUse.length>1&&"."!==Object(s["a"])(this.valueUse)[1]&&"0"===Object(s["a"])(this.valueUse)[0]&&(this.valueUse=this.valueUse.slice(1));var i=r()(this.valueUse);i<this.min&&(this.valueUse=this.min),i>this.max&&(this.valueUse=this.max),this.$emit("input",this.valueUse)},value:function(t){this.valueUse=t}},computed:{}}),c=o,u=(a("04e9"),a("2877")),d=Object(u["a"])(c,i,n,!1,null,"4acd1d9a",null);e["a"]=d.exports},d60c:function(t,e,a){"use strict";var i=a("77ea"),n=a.n(i);n.a},e692:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},ef7c:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"CategorySelector"},[a("el-select",{attrs:{value:t.valueUse,placeholder:t.placeholder},on:{input:t.change}},[t.isFilter?a("el-option",{attrs:{label:t.filterAllText,value:0}}):t._e(),t._l(t.categories,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})],2)],1)},n=[],l=a("1812"),r={name:"CategorySelector",components:{},props:{value:{default:0},isFilter:{default:!1},type:{default:0},placeholder:{default:"请选择"},filterAllText:{default:"全部"}},data:function(){return{categories:[]}},mounted:function(){this.reload()},methods:{reload:function(){this.refreshList(),this.change(this.isFilter?0:null)},change:function(t){this.$emit("input",t)},refreshList:function(){var t=this;this.$ajax.request(l["a"].category.selectByType,{type:this.type}).then(function(e){t.categories=e})}},watch:{type:function(){this.refreshList()}},computed:{valueUse:function(){return this.value?this.value:this.isFilter?0:null}}},s=r,o=(a("0a29"),a("2877")),c=Object(o["a"])(s,i,n,!1,null,"5d265168",null);e["a"]=c.exports},f8d6:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"WarehouseSelector"},[a("el-cascader",{style:{width:t.width},attrs:{value:t.selectArray,placeholder:t.isFilter?"全部":t.plcText,options:t.tree,props:{value:"id",label:"name"},"change-on-select":t.isFilter},on:{change:t.itemChange}})],1)},n=[],l=(a("6762"),a("2fdb"),a("1812")),r=a("8f16"),s={name:"WarehouseSelector",components:{},props:{value:{default:0},isFilter:{default:!1},level:{default:1},visible:{default:!0},width:{default:"200px"},filterIds:{default:function(){return[]}},needFilter:{default:!1}},data:function(){return{warehouses:[],reservoirs:[],stocks:[],tree:[],selectArray:[]}},mounted:function(){this.reload()},methods:{reload:function(){this.refreshList(),this.change(this.isFilter?0:null)},change:function(t){this.$emit("input",t)},refreshList:function(){var t=this;this.$ajax.request(l["a"].warehouse.warSelectAll).then(function(e){if(t.warehouses=e,t.level>1)return t.$ajax.request(l["a"].warehouse.resSelectAll)}).then(function(e){if(t.reservoirs=e,t.level>2)return t.$ajax.request(l["a"].warehouse.stockSelectAll)}).then(function(e){t.stocks=e}).finally(function(){return t.createTree()})},createTree:function(){var t=this;this.tree=r["a"].listToTreeByTwoList(this.warehouses,r["a"].listToTreeByTwoList(this.reservoirs,this.stocks,"reservoirId"),"warehouseId"),this.isFilter?this.tree=[{id:0,name:"全部"}].concat(this.tree):(this.needFilter||this.filterIds.length)&&(this.tree=r["a"].filterTree(this.tree,function(e){return t.filterIds.includes(e.id)},"children",3)),this.refreshSelect()},refreshSelect:function(){var t=this;this.selectArray=r["a"].getTreeRoute(this.tree,function(e){return e.id===t.value},"id","children",this.level)},itemChange:function(t){!this.isFilter&&t.length<this.level||(this.$emit("input",t.length!==this.level?0:t[t.length-1]),this.$emit("change",t))}},watch:{visible:function(t){t&&this.refreshList()},value:function(){this.refreshSelect()},filterIds:function(){this.createTree()}},computed:{valueUse:function(){return this.value?this.value:this.isFilter?0:null},plcText:function(){return"请选择"+["仓库","仓位","货架"][this.level-1]}}},o=s,c=(a("d60c"),a("2877")),u=Object(c["a"])(o,i,n,!1,null,"afa1b522",null);e["a"]=u.exports},fe0a:function(t,e,a){"use strict";var i=a("b13f"),n=a.n(i);n.a}}]);
//# sourceMappingURL=chunk-288bd99c.5a06ae96.js.map