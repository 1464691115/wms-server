(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4f4664f8"],{"172d":function(t,e,i){},"44e7":function(t,e,i){"use strict";var n=i("80fc"),o=i.n(n);o.a},"66c7":function(t,e,i){"use strict";var n=i("ac48"),o=i.n(n);o.a},"7c2a":function(t,e,i){"use strict";var n=i("856c"),o=i.n(n);o.a},"80fc":function(t,e,i){},"856c":function(t,e,i){},"8d7e":function(t,e,i){},a208:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"StockTransManagerView flex-box flex-column"},[i("search-card-layout",{attrs:{loading:t.loading},on:{"click-search":t.refreshData}},[i("div",{staticClass:"flex-box search-card"},[i("div",{},[i("span",[t._v(t._s(t.titleText)+"单号")]),i("el-input",{model:{value:t.filterForm.number,callback:function(e){t.$set(t.filterForm,"number",e)},expression:"filterForm.number"}})],1),i("div",{staticStyle:{width:"200px"}},[i("span",[t._v("审批状态")]),i("approve-selector",{attrs:{"is-filter":!0,"is-stock-in":1===t.type},model:{value:t.filterForm.status,callback:function(e){t.$set(t.filterForm,"status",e)},expression:"filterForm.status"}})],1),i("div",{},[i("span",[t._v("创建时间")]),i("date-time-range-input",{attrs:{"start-time":t.filterForm.startTime,"end-time":t.filterForm.endTime},on:{"update:startTime":function(e){return t.$set(t.filterForm,"startTime",e)},"update:start-time":function(e){return t.$set(t.filterForm,"startTime",e)},"update:endTime":function(e){return t.$set(t.filterForm,"endTime",e)},"update:end-time":function(e){return t.$set(t.filterForm,"endTime",e)}}})],1)]),i("el-button-curd-group",{attrs:{slot:"buttons","delete-disabled":!t.selectedRow.length,"edit-disabled":1!==t.selectedRow.length},on:{"click-add":t.clickAddButton,"click-edit":t.clickEditButton,"click-delete":t.clickDeleteButton},slot:"buttons"},[i("el-button-group",{staticClass:"ml-xs"},[i("el-button-mini",{attrs:{icon:"iconfont icon-notes-medical",disabled:!t.submitEnable},nativeOn:{click:function(e){return t.clickSubmitButton(e)}}},[t._v("提交审核\n                ")]),i("el-button-mini",{attrs:{icon:"iconfont icon-check-circle",disabled:!t.approveEnable},nativeOn:{click:function(e){return t.clickApproveButton(e)}}},[t._v("审批通过\n                ")]),i("el-button-mini",{attrs:{icon:"iconfont icon-times-circle","icon-color-class":"color-red",disabled:!t.rejectEnable},nativeOn:{click:function(e){return t.clickRejectButton(e)}}},[t._v("驳回\n                ")]),1===t.type?i("el-button-mini",{attrs:{icon:"iconfont icon-circle","icon-color-class":"color-olive",disabled:!t.finishEnable},nativeOn:{click:function(e){return t.clickFinishButton(e)}}},[t._v("完成移位\n                ")]):t._e()],1)],1)],1),i("div",{staticClass:"flex-grow"},[i("table-panel",{attrs:{loading:t.loading,data:t.data,paginate:t.paginate,"operate-width":"140",selectedRow:t.selectedRow,"create-user-show":!0,"update-user-show":!0},on:{"update:selectedRow":function(e){t.selectedRow=e},"update:selected-row":function(e){t.selectedRow=e},"sort-change":t.sortChange},scopedSlots:t._u([{key:"operate",fn:function(e){var n=e.row;return[i("el-button-mini",{attrs:{type:"text",icon:"edit",title:"编辑"},nativeOn:{click:function(e){return t.clickRowEditButton(n)}}}),i("el-button-mini",{attrs:{type:"text",title:"预览查看",icon:"iconfont icon-eye1"},nativeOn:{click:function(e){return t.clickRowPreviewButton(n)}}}),1===n.status?i("el-button-mini",{attrs:{type:"text",icon:"delete",title:"删除"},nativeOn:{click:function(e){return t.clickRowDeleteButton(n)}}}):t._e(),[1,4].includes(n.status)&&n.moveCount>0?i("el-button-mini",{attrs:{type:"text",icon:"iconfont icon-notes-medical",title:"提交审批"},nativeOn:{click:function(e){return t.clickRowSubmitButton(n)}}}):t._e(),2===n.status?i("el-button-mini",{attrs:{type:"text",icon:"iconfont icon-check-circle",title:"审批通过"},nativeOn:{click:function(e){return t.clickRowApproveButton(n)}}}):t._e(),2===n.status?i("el-button-mini",{attrs:{type:"text",icon:"iconfont icon-times-circle",title:"驳回"},nativeOn:{click:function(e){return t.clickRowRejectButton(n)}}}):t._e(),3===n.status?i("el-button-mini",{attrs:{type:"text",icon:"iconfont icon-circle",title:"完成移位"},nativeOn:{click:function(e){return t.clickRowFinishButton(n)}}}):t._e()]}}])},[i("el-table-column",{attrs:{prop:"id",label:"ID",sortable:"custom",width:"80"}}),i("el-table-column",{attrs:{prop:"number",label:t.titleText+"单号",sortable:"custom",width:"180"}}),i("el-table-column",{attrs:{prop:"moveCount",label:"明细条数",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[i("el-button-mini",{attrs:{type:"text",title:"查看和编辑明细",icon:"iconfont icon-th-list"},nativeOn:{click:function(e){return t.clickRowDetailButton(n)}}}),[1,4].includes(n.status)?i("el-button-mini",{attrs:{type:"text",icon:"iconfont icon-plus-circle"},nativeOn:{click:function(e){return t.clickRowAddMoveButton(n)}}}):t._e(),i("span",{staticClass:"ml-xs"},[t._v(t._s(n.moveCount))])]}}])}),i("el-table-column",{attrs:{prop:"status",label:t.titleText+"状态",sortable:"custom",width:"105"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return i("div",{staticClass:"flex-box flex-center"},[i("approve-tags",{attrs:{status:n.status,"is-stock-in":1===t.type}}),2===n.type&&5===n.status&&0!==n.deliveryId?i("div",{staticStyle:{"padding-top":"2px","margin-left":"2px"}},[i("el-tag",{staticClass:"cursor-p",attrs:{type:"info"}},[i("i",{staticClass:"iconfont icon-truck"})])],1):t._e()],1)}}])}),i("el-table-column",{attrs:{prop:"stockId",label:"源货架",sortable:"custom",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.stockText(n,!1),placement:"top"}},[i("span",{staticClass:"cursor-p"},[t._v(t._s(n.stockName))])])]}}])}),i("el-table-column",{attrs:{prop:"stockTid",label:"目标货架",sortable:"custom",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.stockText(n,!0),placement:"top"}},[i("span",{staticClass:"cursor-p"},[t._v(t._s(n.stockNameTo))])])]}}])}),i("el-table-column",{attrs:{prop:"remark",label:"备注",width:"200","show-overflow-tooltip":!0}}),i("el-table-column",{attrs:{prop:"rejectRemark",label:"驳回理由",width:"200","show-overflow-tooltip":!0}})],1)],1),i("stock-trans-add-dialog",{attrs:{visible:t.showAddDialog,"edit-id":t.editId},on:{"update:visible":function(e){t.showAddDialog=e},finish:t.refreshData}}),i("trans-move-list-dialog",{attrs:{visible:t.showMoveListDialog,"stock-trans":t.selectStockTrans,type:t.type},on:{"update:visible":function(e){t.showMoveListDialog=e},close:t.refreshData}}),i("trans-move-add-dialog",{attrs:{visible:t.showMoveAddDialog,"edit-id":0,type:t.type,"stock-trans":t.selectStockTrans},on:{"update:visible":function(e){t.showMoveAddDialog=e},finish:t.refreshData}}),i("stock-trans-preview-dialog",{attrs:{visible:t.showPreviewDialog,"edit-id":t.editId,type:t.type},on:{"update:visible":function(e){t.showPreviewDialog=e}}}),i("stock-trans-reject-dialog",{attrs:{visible:t.showRejectDialog,"stock-trans":t.selectStockTrans,type:t.type},on:{"update:visible":function(e){t.showRejectDialog=e},finish:t.refreshData}})],1)},o=[],s=(i("6762"),i("2fdb"),i("5176")),a=i.n(s),r=i("cebc"),c=i("705a"),l=i("7f0d"),u=i("1812"),d=i("41a2"),h=i("b4d6"),f=i("9960"),m=i("461d"),v=i("558e"),p=i("15e2"),b=i("ef7c"),k=i("ee5d"),w=i("3522"),y=i("ec55"),g=i("a992"),T=i("d024"),x=i("f4c8"),S=i("a58e"),D=i("cd0d"),_=i("fc8a"),j=i("d225"),R=i("308d"),O=i("6bb5"),I=i("013f"),C=i("4e2b"),B=i("bd86"),E=i("da3a"),$=function(t){function e(){var t,i;Object(j["a"])(this,e);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return i=Object(R["a"])(this,(t=Object(O["a"])(e)).call.apply(t,[this].concat(o))),Object(B["a"])(Object(I["a"])(i),"startTime",""),Object(B["a"])(Object(I["a"])(i),"endTime",""),i}return Object(C["a"])(e,t),e}(E["a"]),A=function(t){function e(){var t,i;Object(j["a"])(this,e);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return i=Object(R["a"])(this,(t=Object(O["a"])(e)).call.apply(t,[this].concat(o))),Object(B["a"])(Object(I["a"])(i),"id",0),Object(B["a"])(Object(I["a"])(i),"number",""),Object(B["a"])(Object(I["a"])(i),"status",0),Object(B["a"])(Object(I["a"])(i),"remark",""),Object(B["a"])(Object(I["a"])(i),"warehouseTid",0),Object(B["a"])(Object(I["a"])(i),"reservoirTid",0),Object(B["a"])(Object(I["a"])(i),"stockTid",0),Object(B["a"])(Object(I["a"])(i),"warehouseNameTo",""),Object(B["a"])(Object(I["a"])(i),"reservoirNameTo",""),Object(B["a"])(Object(I["a"])(i),"stockNameTo",""),Object(B["a"])(Object(I["a"])(i),"warehouseCodeTo",""),Object(B["a"])(Object(I["a"])(i),"reservoirCodeTo",""),Object(B["a"])(Object(I["a"])(i),"stockCodeTo",""),Object(B["a"])(Object(I["a"])(i),"moveCount",0),Object(B["a"])(Object(I["a"])(i),"approveUid",0),Object(B["a"])(Object(I["a"])(i),"approveUserName",""),Object(B["a"])(Object(I["a"])(i),"rejectRemark",""),i}return Object(C["a"])(e,t),e}($),q=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"TransMoveAddDialog"},[i("el-dialog",{attrs:{visible:t.visible,width:"400px",title:t.title,"close-on-click-modal":!1},on:{"update:visible":t.showDialog}},[i("el-form",{attrs:{"label-position":"top"}},[i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"物料或产品名称",required:!0}},[i("MaterialSelector",{attrs:{types:"1,2,3",width:"100%","filter-ids":t.mtlFilterIds,"need-filter":!0},model:{value:t.move.materialId,callback:function(e){t.$set(t.move,"materialId",e)},expression:"move.materialId"}})],1)],1)],1),i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"当前剩余库存数量",required:!0}},[i("el-input",{attrs:{disabled:!0},model:{value:t.inventory.quantity,callback:function(e){t.$set(t.inventory,"quantity",e)},expression:"inventory.quantity"}})],1)],1),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:"移出数量",required:!0}},[i("el-input-integer",{attrs:{"is-float":!0,max:t.inventory.quantity},model:{value:t.move.quantity,callback:function(e){t.$set(t.move,"quantity",e)},expression:"move.quantity"}})],1)],1)],1),i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"备注",required:!1}},[i("el-input",{attrs:{type:"textarea"},model:{value:t.move.remark,callback:function(e){t.$set(t.move,"remark",e)},expression:"move.remark"}})],1)],1)],1)],1),i("div",{staticClass:"text-right mt-xs"},[i("el-button-submit",{attrs:{loading:t.loading,"is-block":!1},nativeOn:{click:function(e){return t.clickSubmit(e)}}},[t._v("保存提交\n            ")])],1)],1)],1)},F=[],M=i("57ae"),N=i("b5d0"),P=i("e31b"),L=i("3446"),z=i("bf8a"),U=i("f8d6"),J=i("b248"),G={name:"TransMoveAddDialog",components:{WarehouseSelector:U["a"],ElInputInteger:z["a"],MaterialSelector:P["a"],ElButtonSubmit:N["a"],CompanySelector:M["a"],CategorySelector:b["a"]},props:{type:{default:1},visible:{default:!1},editId:{default:0},stockTrans:{default:function(){return new A}}},data:function(){return{loading:!1,move:new L["a"],stkFilterIds:[],mtlFilterIds:[],inventory:new J["a"]}},mounted:function(){this.reload()},methods:{reload:function(){},showDialog:function(t){this.$emit("update:visible",t)},refreshData:function(){var t=this;if(this.refreshSelectorFilter(),!this.editId){var e=this.stockTrans;return this.move=new L["a"],this.move.quantity=0,this.move.stockTransId=e.id,this.move.type=3,this.move.warehouseId=e.warehouseId,this.move.reservoirId=e.reservoirId,this.move.stockId=e.stockId,this.move.warehouseTid=e.warehouseTid,this.move.reservoirTid=e.reservoirTid,this.move.stockTid=e.stockTid,void(this.move.status=e.status)}this.$ajax.request(u["a"].move.getById,{id:this.editId}).then(function(e){t.move=e})},refreshSelectorFilter:function(){var t=this;this.inventory=new J["a"],this.$ajax.request(u["a"].inventory.selectAllMtlIdsByStkId,{stkId:this.stockTrans.stockId}).then(function(e){t.mtlFilterIds=e})},refreshInventory:function(){var t=this;this.$ajax.request(u["a"].inventory.getByMtlAndStk,this.inventory).then(function(e){t.inventory=e||new J["a"]})},clickSubmit:function(){var t=this;this.loading=!0;var e=this.editId?u["a"].move.update:u["a"].move.insert;this.$ajax.request(e,this.move).then(function(e){c["a"].toastSuccess(e),t.showDialog(!1),t.$emit("finish")}).finally(function(){return t.loading=!1})}},watch:{visible:function(t){t&&this.refreshData()},"move.materialId":function(t){this.inventory.materialId=t,this.inventory.stockId=this.stockTrans.stockId,this.refreshInventory()}},computed:{titleText:function(){return 1===this.type?"入库明细":"出库明细"},materialTypes:function(){return 1===this.type?"1,3":"2,3"},title:function(){return this.editId?"编辑 ".concat(this.titleText," ").concat(this.editId):"新增 ".concat(this.titleText)}}},V=G,W=(i("a227"),i("2877")),H=Object(W["a"])(V,q,F,!1,null,"0584395e",null),Q=H.exports,K=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"TransMoveListDialog"},[i("el-dialog",{attrs:{width:"1000px",visible:t.visible,title:t.title},on:{"update:visible":t.showDialog,closed:function(e){return t.$emit("close")}}},[i("div",{staticClass:"mb-xs fz-xs title-text-block"},[i("span",[t._v(t._s(t.typeText)+"单号："+t._s(t.stockTrans.number))]),i("span",[t._v("订单号："+t._s(t.stockTrans.number))]),i("span",[t._v("源货架：\n                "),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.stockText(t.stockTrans,!1),placement:"bottom"}},[i("el-tag",{staticClass:"cursor-p",attrs:{type:"info"}},[t._v(t._s(t.stockTrans.stockName))])],1)],1),i("span",[t._v("目标货架：\n                "),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.stockText(t.stockTrans,!0),placement:"bottom"}},[i("el-tag",{staticClass:"cursor-p",attrs:{type:"success"}},[t._v(t._s(t.stockTrans.stockNameTo))])],1)],1)]),i("div",{staticClass:"mb-xs"},[i("el-button-curd-group",{attrs:{slot:"buttons","add-disabled":!t.canEdit,"delete-disabled":!t.selectedRow.length||!t.canEdit,"edit-disabled":1!==t.selectedRow.length||!t.canEdit},on:{"click-add":t.clickAddButton,"click-edit":t.clickEditButton,"click-delete":t.clickDeleteButton},slot:"buttons"})],1),i("div",{},[i("table-panel",{ref:"table",attrs:{loading:t.loading,data:t.data,"operate-width":"80",selectedRow:t.selectedRow,"create-user-show":!0,"update-user-show":!0,"show-all-warehouse":!1,"show-paginate":!1,"fix-height":360,sortable:null,"show-index":!1},on:{"update:selectedRow":function(e){t.selectedRow=e},"update:selected-row":function(e){t.selectedRow=e}},scopedSlots:t._u([{key:"operate",fn:function(e){var n=e.row;return[t.canEdit?i("el-button-mini",{attrs:{type:"text",icon:"edit"},nativeOn:{click:function(e){return t.clickRowEditButton(n)}}}):t._e(),t.canEdit?i("el-button-mini",{attrs:{type:"text",icon:"delete"},nativeOn:{click:function(e){return t.clickRowDeleteButton(n)}}}):t._e()]}}])},[i("el-table-column",{attrs:{prop:"materialName",label:"物品名称",width:"160"}}),i("el-table-column",{attrs:{prop:"quantity",label:"实际数量",width:"100"}}),i("el-table-column",{attrs:{prop:"materialUnitName",label:"单位",width:"70"}}),i("el-table-column",{attrs:{prop:"stockId",label:"源货架",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.stockText(n,!1),placement:"top"}},[i("span",{staticClass:"cursor-p"},[t._v(t._s(n.stockName))])])]}}])}),i("el-table-column",{attrs:{prop:"stockTid",label:"目标货架",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.stockText(n,!0),placement:"top"}},[i("span",{staticClass:"cursor-p"},[t._v(t._s(n.stockNameTo))])])]}}])})],1)],1)]),i("trans-move-add-dialog",{attrs:{visible:t.showAddDialog,"edit-id":t.editId,type:t.type,"stock-trans":t.stockTrans},on:{"update:visible":function(e){t.showAddDialog=e},finish:t.refreshData}})],1)},X=[],Y={name:"TransMoveListDialog",components:{TransMoveAddDialog:Q,MoveAddDialog:y["a"],ElButtonCurdGroup:v["a"],ElButtonMini:f["a"],TablePanel:m["a"]},props:{visible:{default:!1},stockTrans:{default:function(){return new A}},type:{default:1}},data:function(){return{loading:!1,showAddDialog:!1,data:[],selectedRow:[],editId:0}},mounted:function(){this.reload()},methods:{reload:function(){},showDialog:function(t){this.$emit("update:visible",t)},refreshData:function(){var t=this;this.loading=!0,this.$ajax.request(u["a"].move.selectByStockTransId,{stockTransId:this.stockTrans.id}).then(function(e){t.data=e}).finally(function(){return t.loading=!1})},clickAddButton:function(){this.editId=0,this.showAddDialog=!0},clickEditButton:function(){this.editId=this.selectedRow[0].id,this.showAddDialog=!0},clickDeleteButton:function(){this.delete(this.selectedRow)},clickRowEditButton:function(t){this.editId=t.id,this.showAddDialog=!0},clickRowDeleteButton:function(t){this.delete([t])},delete:function(t){var e=this;c["a"].confirm("\n                确定删除以下".concat(this.typeText,"信息吗？ <br>\n                [ ").concat(t.map(function(t){return t.materialName}).join(",")," ]\n            ")).then(function(){return e.$ajax.request(u["a"].move.delete,{ids:t.map(function(t){return t.id}).join(",")})}).then(function(t){c["a"].toastSuccess(t),e.refreshData()})},stockText:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=e?"To":"";return[t["warehouseCode"+i],t["reservoirCode"+i],t["stockCode"+i]+"(".concat(t["stockName"+i],")")].join(" / ")}},watch:{visible:function(t){t&&this.refreshData()}},computed:{title:function(){return"".concat(this.typeText,"单明细 ").concat(this.stockTrans.number)},typeText:function(){return"移位"},canEdit:function(){return[1,4].includes(this.stockTrans.status)}}},Z=Y,tt=(i("d53e"),Object(W["a"])(Z,K,X,!1,null,"445327a4",null)),et=tt.exports,it=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"StockTransAddDialog"},[i("el-dialog",{attrs:{visible:t.visible,width:"400px",title:t.title,"close-on-click-modal":!1},on:{"update:visible":t.showDialog}},[i("el-form",{attrs:{"label-position":"top"}},[i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:t.titleText+"单"}},[i("el-input",{attrs:{disabled:!0,value:t.stockTrans.number,placeholder:"单号将由系统自动生成"}})],1)],1)],1),i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"源货架",required:!0}},[i("warehouse-selector",{attrs:{width:"100%",level:3,value:t.stockTrans.stockId,"need-filter":!0,"filter-ids":t.stockFilters},on:{change:t.changeStock}})],1)],1)],1),i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"目标货架",required:!0}},[i("warehouse-selector",{attrs:{width:"100%",level:3,value:t.stockTrans.stockTid},on:{change:t.changeStockTo}})],1)],1)],1),i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"备注"}},[i("el-input",{attrs:{type:"textarea"},model:{value:t.stockTrans.remark,callback:function(e){t.$set(t.stockTrans,"remark",e)},expression:"stockTrans.remark"}})],1)],1)],1)],1),i("div",{staticClass:"text-right mt-xs"},[i("el-button-submit",{attrs:{"is-block":!1},nativeOn:{click:function(e){return t.clickSubmit(e)}}},[t._v("保存提交\n            ")])],1)],1)],1)},nt=[],ot=i("7480"),st={name:"StockTransAddDialog",components:{MaterialSelector:P["a"],WarehouseSelector:U["a"],ElButtonSubmit:N["a"],CompanySelector:M["a"],CategorySelector:b["a"]},props:{visible:{default:!1},editId:{default:0}},data:function(){return{stockTrans:new A,stockFilters:[]}},mounted:function(){this.reload()},methods:{reload:function(){},showDialog:function(t){this.$emit("update:visible",t)},refreshData:function(){var t=this;this.refreshFilters(),this.editId?this.$ajax.request(u["a"].stockTrans.getById,{id:this.editId}).then(function(e){t.stockTrans=e}):this.stockTrans=new ot["a"](this.type)},refreshFilters:function(){var t=this;this.$ajax.request(u["a"].inventory.selectAllStockIds).then(function(e){t.stockFilters=e})},clickSubmit:function(){var t=this,e=this.editId?u["a"].stockTrans.update:u["a"].stockTrans.insert;this.$ajax.request(e,this.stockTrans).then(function(e){c["a"].toastSuccess(e),t.showDialog(!1),t.$emit("finish")})},changeStock:function(t){this.stockTrans.warehouseId=t[0],this.stockTrans.reservoirId=t[1],this.stockTrans.stockId=t[2]},changeStockTo:function(t){this.stockTrans.warehouseTid=t[0],this.stockTrans.reservoirTid=t[1],this.stockTrans.stockTid=t[2]}},watch:{visible:function(t){t&&this.refreshData()}},computed:{titleText:function(){return"移位"},categoryType:function(){return 1===this.type?3:4},title:function(){return this.editId?"编辑 ".concat(this.titleText," ").concat(this.editId):"新增 ".concat(this.titleText)},companyText:function(){return 1===this.type?"供应商":"客户"},companyType:function(){return 1===this.type?1:2}}},at=st,rt=(i("66c7"),Object(W["a"])(at,it,nt,!1,null,"37e75fab",null)),ct=rt.exports,lt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"StockTransRejectDialog"},[i("el-dialog",{attrs:{visible:t.visible,width:"300px",title:"请填写驳回理由"},on:{"update:visible":t.showDialog}},[i("el-form",{attrs:{"label-position":"top"}},[i("el-form-item",{attrs:{label:"单号"}},[i("el-input",{attrs:{value:t.form.number,disabled:!0}})],1),i("el-form-item",{attrs:{label:"驳回理由",required:!0}},[i("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:10}},model:{value:t.form.rejectRemark,callback:function(e){t.$set(t.form,"rejectRemark",e)},expression:"form.rejectRemark"}})],1)],1),i("div",{},[i("el-button-submit",{attrs:{loading:t.loading},nativeOn:{click:function(e){return t.submit(e)}}},[t._v("提交驳回\n            ")])],1)],1)],1)},ut=[],dt={name:"StockTransRejectDialog",components:{ElButtonSubmit:N["a"]},props:{visible:{default:!1},stockTrans:{default:function(){return new A}}},data:function(){return{form:a()({},this.stockTrans),loading:!1}},mounted:function(){this.reload()},methods:{reload:function(){},showDialog:function(t){this.$emit("update:visible",t)},submit:function(){var t=this;this.loading=!0,this.form.status=4,this.$ajax.request(u["a"].stockTrans.approve,this.form).then(function(e){c["a"].toastSuccess(e),t.showDialog(!1),t.$emit("finish")}).finally(function(){return t.loading=!1})}},watch:{visible:function(t){t&&(this.form=a()({},this.stockTrans))}},computed:{}},ht=dt,ft=(i("7c2a"),Object(W["a"])(ht,lt,ut,!1,null,"6f19f10d",null)),mt=ft.exports,vt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"StockTransPreviewDialog"},[i("el-dialog",{attrs:{visible:t.visible,"modal-append-to-body":!0,width:"1000px","custom-class":"full-height-dialog","append-to-body":!0},on:{"update:visible":t.showDialog}},[i("div",{staticClass:"flex-box flex-center",attrs:{slot:"title"},slot:"title"},[i("div",{staticClass:"mr-md"},[t._v(t._s(t.typeText+"单预览 "+t.stockEntry.number))]),i("el-button-mini",{attrs:{icon:"iconfont icon-print"},nativeOn:{click:function(e){return t.clickPrintButton(e)}}},[t._v("打印\n            ")])],1),i("iframe",{ref:"iframe",staticStyle:{width:"100%",border:"none",height:"100%"}}),i("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"infoBlock"},[i("div",{},[i("div",{staticStyle:{"font-size":"20pt","margin-bottom":"20pt","text-align":"center"}},[t._v("\n                    "+t._s(t.typeText)+"单\n                ")]),i("table",{staticStyle:{"border-collapse":"collapse","text-align":"center","font-size":"11pt",width:"100%"},attrs:{border:"true"}},[i("thead",[i("tr",{staticClass:"tr-iframe"},[i("th",{style:t.tdStyle},[t._v(t._s(t.typeText)+"单号")]),i("th",{style:t.tdStyle},[t._v("订单号")]),i("th",{style:t.tdStyle},[t._v("公司编号")]),i("th",{style:t.tdStyle},[t._v("公司名称")])])]),i("tbody",[i("tr",{staticClass:"tr-iframe"},[i("td",{style:t.tdStyle},[t._v(t._s(t.stockEntry.number))]),i("td",{style:t.tdStyle},[t._v(t._s(t.stockEntry.orderNumber))]),i("td",{style:t.tdStyle},[t._v(t._s(t.stockEntry.companyCode))]),i("td",{style:t.tdStyle},[t._v(t._s(t.stockEntry.companyName))])])])]),i("div",{staticStyle:{"font-size":"12pt","text-align":"center",margin:"4pt 0 2pt 0"}},[t._v("\n                    明细\n                ")]),i("table",{staticStyle:{"border-collapse":"collapse","text-align":"center","font-size":"11pt",width:"100%"},attrs:{border:"true"}},[i("thead",[i("tr",{staticClass:"tr-iframe"},[i("th",{style:t.tdStyle,attrs:{width:"300"}},[t._v("物料编号")]),i("th",{style:t.tdStyle,attrs:{width:"200"}},[t._v("物料名称")]),i("th",{style:t.tdStyle,attrs:{width:"160"}},[t._v("计划数量")]),i("th",{style:t.tdStyle,attrs:{width:"260"}},[t._v("实际数量")]),i("th",{style:t.tdStyle,attrs:{width:"260"}},[t._v("货架编号")]),i("th",{style:t.tdStyle,attrs:{width:"260"}},[t._v("货架名称")]),i("th",{style:t.tdStyle,attrs:{width:"260"}},[t._v("状态")]),i("th",{style:t.tdStyle,attrs:{width:"260"}},[t._v("审核人")]),i("th",{style:t.tdStyle,attrs:{width:"260"}},[t._v("审核时间")])])]),i("tbody",t._l(t.moves,function(e,n){return i("tr",{key:e.id,staticClass:"tr-iframe"},[i("td",{style:t.tdStyle},[t._v(t._s(e.materialCode))]),i("td",{style:t.tdStyle},[t._v(t._s(e.materialName))]),i("td",{style:t.tdStyle},[t._v(t._s(e.planQuantity))]),i("td",{style:t.tdStyle},[t._v(t._s(e.quantity))]),i("td",{style:t.tdStyle},[t._v(t._s(e.stockCode))]),i("td",{style:t.tdStyle},[t._v(t._s(e.stockName))]),i("td",{style:t.tdStyle},[t._v(t._s(t.statusEnum[e.status]))]),i("td",{style:t.tdStyle},[t._v(t._s(e.approveUserName))]),i("td",{style:t.tdStyle},[t._v(t._s(e.approveTime))])])}),0)])])])])],1)},pt=[],bt=i("834a"),kt={name:"StockTransPreviewDialog",components:{ElButtonMini:f["a"]},props:{visible:{default:!1},type:{default:1},editId:{default:0}},data:function(){return{stockEntry:new ot["a"],moves:[],loading:!1,statusEnum:T["a"][1===this.type?"dictIn":"dictOut"]}},mounted:function(){this.reload()},methods:{reload:function(){},showDialog:function(t){this.$emit("update:visible",t)},refreshData:function(){var t=this;this.stockEntry=new ot["a"],this.moves=[],this.loading=!0,this.$ajax.request(u["a"].stockEntry.getById,{id:this.editId}).then(function(e){return t.stockEntry=e,t.$ajax.request(u["a"].move.selectByStockEntryId,{stockEntryId:t.editId})}).then(function(e){t.moves=e,t.setDoc()}).finally(function(){return t.loading=!1})},setDoc:function(){var t=this;this.$nextTick(function(){bt["a"].setDoc(t.$refs.infoBlock.innerHTML,t.$refs.iframe)})},clickPrintButton:function(){var t=this;this.$nextTick(function(){bt["a"].print(t.$refs.iframe)})}},watch:{visible:function(t){var e=this;t&&this.$nextTick(function(){e.refreshData()})}},computed:{typeText:function(){return 1===this.type?"入库":"出库"},tdStyle:function(){return{padding:"3pt 1pt"}}}},wt=kt,yt=(i("e9d8"),Object(W["a"])(wt,vt,pt,!1,null,"17773688",null)),gt=yt.exports,Tt={name:"StockTransManagerView",components:{StockTransPreviewDialog:gt,StockTransRejectDialog:mt,StockTransAddDialog:ct,TransMoveListDialog:et,TransMoveAddDialog:Q,StockEntryDeliveryFinishDialog:_["a"],StockEntryRejectDialog:D["a"],StockEntryPreviewDialog:S["a"],ApproveTags:x["a"],ApproveSelector:g["a"],MoveAddDialog:y["a"],MoveListDialog:w["a"],StockEntryAddDialog:k["a"],CategorySelector:b["a"],DateTimeRangeInput:p["a"],ElButtonCurdGroup:v["a"],TablePanel:m["a"],ElButtonMini:f["a"],SearchCardLayout:h["a"]},props:{type:{default:1}},data:function(){return{loading:!1,showAddDialog:!1,showMoveListDialog:!1,showMoveAddDialog:!1,showPreviewDialog:!1,showRejectDialog:!1,showDeliveryFinishDialog:!1,filterForm:new A,data:[],paginate:new l["a"](this.refreshData),selectedRow:[],sortingColumn:null,editId:0,selectStockTrans:new A,statusEnum:T["a"]}},mounted:function(){this.reload()},methods:{reload:function(){this.refreshData()},refreshData:function(){var t=this;this.loading=!0,this.$ajax.request(u["a"].stockTrans.list,Object(r["a"])({},d["a"].getSortField(this.sortingColumn),this.paginate.getJSON(),this.filterForm)).then(function(e){t.data=e.list,t.paginate.setPaginate(e)}).finally(function(){return t.loading=!1})},sortChange:function(t){this.sortingColumn=t,this.refreshData()},clickAddButton:function(){this.editId=0,this.selectStockTrans=this.selectedRow[0],this.showAddDialog=!0},clickEditButton:function(){this.editId=this.selectedRow[0].id,this.showAddDialog=!0},clickDeleteButton:function(){this.delete(this.selectedRow)},clickRowEditButton:function(t){this.editId=t.id,this.showAddDialog=!0},clickRowDeleteButton:function(t){this.delete([t])},clickRowDetailButton:function(t){this.selectStockTrans=t,this.showMoveListDialog=!0},clickRowPreviewButton:function(t){this.editId=t.id,this.showPreviewDialog=!0},clickRowAddMoveButton:function(t){this.editId=0,this.selectStockTrans=t,this.showMoveAddDialog=!0},delete:function(t){var e=this;c["a"].confirm("\n                确定删除以下移位单吗？ <br>\n                [ ".concat(t.map(function(t){return t.number}).join(",")," ]\n            ")).then(function(){return e.$ajax.request(u["a"].stockTrans.delete,{ids:t.map(function(t){return t.id}).join(",")})}).then(function(t){c["a"].toastSuccess(t),e.refreshData()})},clickApproveButton:function(){this.approve(this.selectedRow,!0,"通过审批")},clickRowApproveButton:function(t){this.approve([t],!0,"通过审批")},clickRejectButton:function(){this.selectStockTrans=this.selectedRow[0],this.showRejectDialog=!0},clickRowRejectButton:function(t){this.selectStockTrans=t,this.showRejectDialog=!0},approve:function(t){var e=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"通过";c["a"].confirm("\n                确定要将以下移位单 ".concat(n," 吗？ </br>\n                [ ").concat(t[0].number," ]\n            ")).then(function(){var n=a()({},t[0]);return n.status=i?3:4,e.$ajax.request(u["a"].stockTrans.approve,n)}).then(function(t){c["a"].toastSuccess(t),e.refreshData()})},clickFinishButton:function(){this.finishSE(this.selectedRow)},clickRowFinishButton:function(t){this.finishSE([t])},finishSE:function(t){var e=this;c["a"].confirm("\n                确定要完成以下移位单？ </br>\n                [ ".concat(t[0].number," ]\n            ")).then(function(){var i=a()({},t[0]);return i.status=5,e.$ajax.request(u["a"].stockTrans.finish,i)}).then(function(t){c["a"].toastSuccess(t),e.refreshData()})},clickSubmitButton:function(){this.submit(this.selectedRow)},clickRowSubmitButton:function(t){this.submit([t])},submit:function(t){var e=this;c["a"].confirm("\n                确定要将以下移位单提交审核吗？ </br>\n                [ ".concat(t[0].number," ]\n            ")).then(function(){return e.$ajax.request(u["a"].stockTrans.submit,t[0])}).then(function(t){c["a"].toastSuccess(t),e.refreshData()})},clickDeliveryButton:function(){this.selectStockTrans=this.selectedRow[0],this.showDeliveryFinishDialog=!0},clickRowDeliveryButton:function(t){this.selectStockTrans=t,this.showDeliveryFinishDialog=!0},delivery:function(t){},stockText:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=e?"To":"";return[t["warehouseCode"+i],t["reservoirCode"+i],t["stockCode"+i]+"(".concat(t["stockName"+i],")")].join(" / ")}},watch:{},computed:{titleText:function(){return"移位"},categoryType:function(){return 1===this.type?3:4},submitEnable:function(){return 1===this.selectedRow.length&&[1,4].includes(this.selectedRow[0].status)},approveEnable:function(){return 1===this.selectedRow.length&&2===this.selectedRow[0].status},rejectEnable:function(){return 1===this.selectedRow.length&&2===this.selectedRow[0].status},finishEnable:function(){return 1===this.selectedRow.length&&3===this.selectedRow[0].status}}},xt=Tt,St=(i("44e7"),Object(W["a"])(xt,n,o,!1,null,"616c655b",null));e["default"]=St.exports},a227:function(t,e,i){"use strict";var n=i("8d7e"),o=i.n(n);o.a},ac48:function(t,e,i){},d53e:function(t,e,i){"use strict";var n=i("f0bd"),o=i.n(n);o.a},e9d8:function(t,e,i){"use strict";var n=i("172d"),o=i.n(n);o.a},f0bd:function(t,e,i){}}]);
//# sourceMappingURL=chunk-4f4664f8.84f5a2ce.js.map